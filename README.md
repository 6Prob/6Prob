# 6Prob: Efficient and Dealiased Discovery of Active IPv6 Addresses

### Abstract
With the rapid expansion of IPv6 implementation, active IPv6 address discovery has emerged as a fundamental aspect of Internet security and measurement research. Regrettably, the extensive IPv6 address space renders the traditional brute force scanning approach, commonly used in IPv4, impractical. Presently, a prevalent approach for active IPv6 address discovery involves utilizing IPv6 hitlists, which consist of known active IPv6 addresses, as initial seed addresses to generate additional candidate IPv6 addresses that are subsequently verified for their activeness. Nonetheless, previous endeavors in this domain have encountered challenges in finding a decent amount of active addresses while also needing to improve in accurately and effectively detecting aliased prefixes.

This paper proposes 6Prob, a probabilistic generation model integrated with a tree-based data structure, to discover active IPv6 addresses efficiently. 6Prob dynamically organizes addresses into fine-grained patterns, distributes probes among active patterns, and updates the model with real-time probing results. To address the challenge of detecting aliased prefixes and mitigating the random packet loss brought by ICMPv6 rate limiting, we introduce a cool-down aliased prefix detection (APD) scheme. Leveraging the identified aliased prefixes, we enhance the quality of seed addresses and addresses generated by the model, as these prefixes can mislead the probabilistic generation model. We conducted comprehensive evaluations demonstrating that 6Prob can generate 3.6x more active addresses than prior works. The cool-down APD can detect more aliased prefixes than previous work using fewer resources. Additionally, we conducted extensive measurements on IPv6-based SSH and TLS protocols, showcasing 6Prob's effectiveness in supporting IPv6 measurement research and revealing the current state of IPv6 security.

### Compile
go version go1.17.5

Build executable file `6prob` by

```
go build -o 6prob
```

or you can directly run from source by

```
go run main.go -h
```

### Usage
```
6prob -module=std -input=<input file> -output=<output file>
```
> Module `std` is used to standardize addresses to the form with no abbreviation. (2402:123::1 => 2402:0123:0000:0000:0000:0000:0000:0001).

```
6prob -module=scan -input=<input file> -output=<output file> [-source-ip=<source IP> -n-scan-proc=<# scan processes>]
```
> Module `scan` is used to scan addresses in the input file and output active addresses to the output file.

```
6prob -module=shuffle -input=<input file> -output=<output file>
```
> Module `shuffle` is used to randomly premute the address in the input file and output results to the output file.

```
6prob -module=sort -input=<input file> -output=<output file>
```
> Module `sort` is used to sort addresses in the input file in the Lexicographic order and output results to the output file.

```
6prob -module=filAlias -input=<input file> -output=<output file> -alias=<alias file>
```
> Module `filAlias` is used to filter addresses in the input file with aliased prefixes in the alias file and output results to the output file.

```
6prob -module=gen -input=<input file> -output=<output file> -alias=<alias file> -budget=<# generated addresses> -out-alias=<alias output file> [-source-ip=<source IP> -n-proc=<# processes for generating and updating> -n-scan-proc=<# scan processes>]
```
> Module `gen` uses 6Prob model to generate new addresses based on addresses in the input file. Alias file is used to prevent model generating alias addresses. Budget is the number of generated addresses you want. Alias output file is used to store the aliased prefixes detected by the online cool-down APD.

> 6Prob need input file (often active addresses in the IPv6 Hitlist) as heuristics. During the generation, it avoids generating aliased addresses by filtering generated addresses by aliased file and performing online cool-down APD. The newly-detected aliased prefixes from the online cool-down APD is exported to alias output file.

```
6prob -module=detAlias -input=<input file> -output=<output file> [-source-ip=<source IP> -n-scan-proc=<# scan processes>]
```
> Module `detAlias` uses cool-down detection for aliased prefixes to detect aliased prefixes in the input file and output them to the output file.

```
6prob -module=dealiasScan -input=<input file> -output=<output file> -alias=<alias file> [-source-ip=<source IP> -n-scan-proc=<# scan processes>]
```
> Module `dealiasScan` is used to scan addresses in the input file but ignore aliased addresses covered by ailas prefixes in the alias file.

```
6prob -module=6gen -input=<input file> -output=<output file> -alias=<alias file> -budget=<# generated addresses> [-source-ip=<source IP> -n-proc=<# processes for initialization> -n-scan-proc=<# scan processes>]
```
> Module `6gen` uses 6Gen to generate new addresses based on addresses in the input file.

```
6prob -module=getPfx -input=<input file> -output=<output file> -thres=<# hosts>
```
> Module `getPfx` gets prefixes with more than thres hosts presented in the input file and output results to output file.

```
6prob -module=genAlias -input=<input file> -output=<output file> -thres=<threshold distance>
```
> Module `genAlias` generates new aliased prefixes based on ones in the input file with the threshold distance.














